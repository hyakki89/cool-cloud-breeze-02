{{ 'section-product-info.css' | asset_url | stylesheet_tag }}

<div class="product-info color-{{ section.settings.color_scheme }} section-{{ section.id }}-padding">
  <div class="page-width">
    <div class="product-info-container">
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when 'title' -%}
            <div class="product-title-block" {{ block.shopify_attributes }}>
              <h1 class="product-title">{{ product.title }}</h1>
            </div>
            
          {%- when 'price' -%}
            <div class="product-price-block" {{ block.shopify_attributes }}>
              <div class="price-wrapper">
                <span class="price">
                  {%- if product.compare_at_price > product.price -%}
                    <span class="price-regular">{{ product.price | money }}</span>
                    <span class="price-compare">{{ product.compare_at_price | money }}</span>
                  {%- else -%}
                    <span class="price-regular">{{ product.price | money }}</span>
                  {%- endif -%}
                </span>
                {%- if block.settings.show_savings and product.compare_at_price > product.price -%}
                  <span class="price-savings">
                    Économisez {{ product.compare_at_price | minus: product.price | money }}
                  </span>
                {%- endif -%}
              </div>
            </div>
            
          {%- when 'variant_picker' -%}
            <div class="product-variant-picker" {{ block.shopify_attributes }}>
              {%- unless product.has_only_default_variant -%}
                {%- for option in product.options_with_values -%}
                  <div class="product-option">
                    <label class="option-label">{{ option.name }}</label>
                    <div class="option-values">
                      {%- for value in option.values -%}
                        <input
                          type="radio"
                          id="option-{{ option.position }}-{{ forloop.index0 }}"
                          name="options[{{ option.name | escape }}]"
                          value="{{ value | escape }}"
                          class="option-input"
                          {%- if option.selected_value == value -%}checked{%- endif -%}
                        />
                        <label for="option-{{ option.position }}-{{ forloop.index0 }}" class="option-label-button">
                          {{ value }}
                        </label>
                      {%- endfor -%}
                    </div>
                  </div>
                {%- endfor -%}
              {%- endunless -%}
              
              {%- if block.settings.show_quantity_selector -%}
                <div class="quantity-selector">
                  <label for="quantity" class="quantity-label">Quantité</label>
                  <div class="quantity-input-wrapper">
                    <button class="quantity-button quantity-decrease" type="button">-</button>
                    <input type="number" id="quantity" name="quantity" value="1" min="1" class="quantity-input">
                    <button class="quantity-button quantity-increase" type="button">+</button>
                  </div>
                </div>
              {%- endif -%}
            </div>
            
          {%- when 'buy_buttons' -%}
            <div class="product-buy-buttons" {{ block.shopify_attributes }}>
              <form action="/cart/add" method="post" enctype="multipart/form-data" id="product-form">
                <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                <div class="buy-buttons-wrapper">
                  <button
                    type="submit"
                    name="add"
                    class="btn product-form__cart-submit"
                    {%- if product.selected_or_first_available_variant.available == false -%}disabled{%- endif -%}
                  >
                    <span>
                      {%- if product.selected_or_first_available_variant.available -%}
                        Ajouter au panier - {{ product.selected_or_first_available_variant.price | money }}
                      {%- else -%}
                        Épuisé
                      {%- endif -%}
                    </span>
                  </button>
                  
                  {%- if block.settings.show_dynamic_checkout -%}
                    {{ form | payment_button }}
                  {%- endif -%}
                </div>
              </form>
            </div>
            
          {%- when 'description' -%}
            <div class="product-description" {{ block.shopify_attributes }}>
              {%- if product.description != blank -%}
                <div class="product-description-content">
                  {{ product.description }}
                </div>
              {%- endif -%}
            </div>
            
          {%- when 'collapsible_tab' -%}
            <div class="collapsible-tab" {{ block.shopify_attributes }}>
              <details class="collapsible-details">
                <summary class="collapsible-summary">
                  <span class="collapsible-title">{{ block.settings.heading }}</span>
                  <span class="collapsible-icon">+</span>
                </summary>
                <div class="collapsible-content">
                  {%- if block.settings.content != blank -%}
                    {{ block.settings.content }}
                  {%- endif -%}
                  {%- if block.settings.page != blank -%}
                    {{ pages[block.settings.page].content }}
                  {%- endif -%}
                </div>
              </details>
            </div>
        {%- endcase -%}
      {%- endfor -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Product Information",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "background-1"
    },
    {
      "type": "header",
      "content": "Section padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "title",
      "name": "Title",
      "limit": 1
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_savings",
          "default": true,
          "label": "Show savings"
        }
      ]
    },
    {
      "type": "variant_picker",
      "name": "Variant picker",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_quantity_selector",
          "default": true,
          "label": "Show quantity selector"
        }
      ]
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "limit": 1,
      "settings": [
        {
          "type": "checkbox",
          "id": "show_dynamic_checkout",
          "default": true,
          "label": "Show dynamic checkout buttons"
        }
      ]
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1
    },
    {
      "type": "collapsible_tab",
      "name": "Collapsible tab",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "default": "Collapsible tab",
          "label": "Heading"
        },
        {
          "type": "richtext",
          "id": "content",
          "label": "Tab content"
        },
        {
          "type": "page",
          "id": "page",
          "label": "Tab content from page"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Information"
    }
  ]
}
{% endschema %}